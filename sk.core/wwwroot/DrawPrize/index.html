<!DOCTYPE HTML>
<html>

<head>
  <meta charset="utf-8">
  <title>福气大转盘</title>
  <meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="full-screen" content="true" />
  <meta name="screen-orientation" content="portrait" />
  <meta name="x5-fullscreen" content="true" />
  <meta name="360-fullscreen" content="true" />
  <meta http-equiv="pragma" content="no-cache">
  <style>
    * {
            margin: 0;
            padding: 0;
        }
    #cans{

            position: absolute !important;
            transform: translate(0,-50%) !important;
            left: 7% !important;
            top: 49% !important;
            height: 61% !important;
            margin: auto !important;
            width: 86% !important;
            overflow: hidden !important;
        }
    </style>
  <script>
    window.onerror = function () {
            return true;
        }
        window.onreset = function () {
            var default_font_size = parseFloat(document.documentElement.clientHeight / 50);
            var docWid = window.document.documentElement;
            docWid.style.fontSize = default_font_size + 'px';
        }
        window.onreset();

        if (!localStorage.getItem("token")) {
            ZlanLuck.Login("");
        }
        var shuaxin = function () {
            location = "/DrawPrize/index.html?t=" + new Date().getTime();
        }
    </script>
  <script egret="lib" src="/drawprize/libs/modules/egret/egret.min.js"></script>
  <script egret="lib" src="/drawprize/libs/modules/egret/egret.web.min.js"></script>
  <script egret="lib" src="/drawprize/libs/modules/eui/eui.min.js"></script>
  <script egret="lib" src="/drawprize/libs/modules/res/res.min.js"></script>
  <script egret="lib" src="/drawprize/libs/modules/game/game.min.js"></script>
  <script egret="lib" src="/drawprize/libs/modules/game/game.web.min.js"></script>
  <script egret="lib" src="/drawprize/libs/modules/tween/tween.min.js"></script>
  <script src="./resource/Json/draw.js?v=11"></script>
  <script>
    var AssetAdapter = function () { function e() { } var t = (__define, e), i = t.prototype; return i.getAsset = function (e, t, i) { function n(n) { t.call(i, n, e) } if (RES.hasRes(e)) { var a = RES.getRes(e); a ? n(a) : RES.getResAsync(e, n, this) } else RES.getResByUrl(e, n, this, RES.ResourceItem.TYPE_IMAGE) }, e }(); egret.registerClass(AssetAdapter, "AssetAdapter", ["eui.IAssetAdapter"]); var GamePlaying = function (e) { function t() { e.call(this), this.PrizeNum = 12, this.LoadPicNum = 0, this.WillLoadPicNum = 0, t.GameContent = this, window.ZlanLuck || (window.ZlanLuck = {}), window.ZlanLuck.LuckStart = this.LuckStart, window.ZlanLuck.LoadPrize = this.LoadPrize, window.ZlanLuck.giftCode = null, window.ZlanLuck.SetPrize = this.SetPrize, window.ZlanLuck.LuckButton && (window.ZlanLuck.LuckButton.width && (t.DIY_LOTTERY_WIDTH = window.ZlanLuck.LuckButton.width), window.ZlanLuck.LuckButton.height && (t.DIY_LOTTERY_HEIGHT = window.ZlanLuck.LuckButton.height), window.ZlanLuck.LuckButton.x && (t.DIY_LOTTERY_X = window.ZlanLuck.LuckButton.x), window.ZlanLuck.LuckButton.y && (t.DIY_LOTTERY_Y = window.ZlanLuck.LuckButton.y)), window.ZlanLuck.Award && (window.ZlanLuck.Award.width && (t.DIY_AWARD_WIDTH = window.ZlanLuck.Award.width), window.ZlanLuck.Award.minspeed && (t.MARK_CHANGE_TIMES_PER_SECOND_MIN = window.ZlanLuck.Award.minspeed), window.ZlanLuck.Award.maxspeed && (t.MARK_CHANGE_TIMES_PER_SECOND_MAX = window.ZlanLuck.Award.maxspeed), window.ZlanLuck.Award.lastpxtime && (t.LASTPXTIME = window.ZlanLuck.Award.lastpxtime)), this.panelList || (this.panelList = ["resource/assets/panel0.png", "resource/assets/panel1.png", "resource/assets/panel2.png"]), this.skinName = "GamePlayingSkin", this.init(); var i = { height: 900, top: 0, left: 0, width: 900 }; window.ZlanLuck.Background && (window.ZlanLuck.Background.panelList && (this.panelList = window.ZlanLuck.Background.panelList), window.ZlanLuck.Background.x && (i.left = window.ZlanLuck.Background.x), window.ZlanLuck.Background.y && (i.top = window.ZlanLuck.Background.y), window.ZlanLuck.Background.width && (i.width = window.ZlanLuck.Background.width), window.ZlanLuck.Background.height && (i.height = window.ZlanLuck.Background.height)), this.panel.height = i.height, this.panel.top = i.top, this.panel.left = i.left, this.panel.width = i.width, window.ZlanLuck.PrizeNum && (this.PrizeNum = window.ZlanLuck.PrizeNum, this.SetPrizeSite(this.PrizeNum)), window.ZlanLuck.OnLoad && window.ZlanLuck.OnLoad() } __extends(t, e); var i = (__define, t), n = i.prototype; return n.SetPrizeSite = function (e) { var i = [[], [], []]; if (12 == e ? i.push([]) : (t.ROW_NUM = 3, t.COL_NUM = 3, t.AWARD_WIDTH = 240, t.AWARD_COUNT = 8, t.BTN_LOTTERY_WIDTH = 240, t.AWARD_RDS = t.AWARD_WIDTH / 5, window.ZlanLuck.Award && window.ZlanLuck.Award.radius && (t.AWARD_RDS = Window.ZlanLuck.Award.radius)), t.DIY_AWARD_WIDTH > 0 && (t.AWARD_WIDTH = t.DIY_AWARD_WIDTH), t.MARGIN = (t.AWARD_PANEL_WIDTH - t.AWARD_WIDTH * t.ROW_NUM) / (t.ROW_NUM + 1), 12 == e) { for (var n = 0; 4 > n; n++) i[0].push({}); for (var n = 4; 6 > n; n++) i[1].push({}); for (var n = 6; 8 > n; n++) i[2].push({}); for (var n = 8; 12 > n; n++) i[3].push({}) } else { for (var n = 0; 3 > n; n++) i[0].push({}); for (var n = 3; 5 > n; n++) i[1].push({}); for (var n = 5; 8 > n; n++) i[2].push({}) } for (var n = 0, a = i.length; a > n; n++) for (var r = 0, o = i[n].length; o > r; r++) { var s = i[n][r], d = new egret.Shape, l = d.graphics; l.lineStyle(2, 16711680, 0), l.beginFill(16777215, .8), l.drawRoundRect(0, 0, t.AWARD_WIDTH, t.AWARD_WIDTH, t.AWARD_RDS, t.AWARD_RDS), l.endFill(); var h = new egret.TextField; h.text = "Load...", h.height = t.AWARD_WIDTH, h.width = t.AWARD_WIDTH, h.textAlign = "center", h.verticalAlign = "middle"; var u = { x: (1 == n || 2 == n && 4 == t.ROW_NUM) && 1 == r ? t.AWARD_PANEL_X + t.MARGIN * t.ROW_NUM + t.AWARD_WIDTH * (t.ROW_NUM - 1) : t.AWARD_PANEL_X + t.MARGIN * (r + 1) + t.AWARD_WIDTH * r, y: t.AWARD_PANEL_Y + t.MARGIN * (n + 1) + t.AWARD_WIDTH * n }; d.blendMode = egret.BlendMode.ADD, d.x = u.x, d.y = u.y, h.x = u.x, h.y = u.y, h.textColor = 0, h.size = 30, t.GameContent.addChild(d), t.GameContent.addChild(h), s.gvd = d, s.gtext = h } t.LoadArr = i, t.GameContent.Pushluckbutton() }, n.LoadPrize = function (e) { if (e || (e = RES.getRes("awards")), e.length && (12 == e.length || 8 == e.length)) { if (window.ZlanLuck.PrizeNum) { if (t.GameContent.PrizeNum != e.length) return void console.log("奖品数量和设置数量不符") } else t.GameContent.SetPrizeSite(e.length); var i = [[], [], []]; if (12 == e.length && i.push([]), 12 == e.length) { for (var n = 0; 4 > n; n++) i[0].push(e[n]); for (var n = 4; 6 > n; n++) i[1].push(e[n]); for (var n = 6; 8 > n; n++) i[2].push(e[n]); for (var n = 8; 12 > n; n++) i[3].push(e[n]) } else { for (var n = 0; 3 > n; n++) i[0].push(e[n]); for (var n = 3; 5 > n; n++) i[1].push(e[n]); for (var n = 5; 8 > n; n++) i[2].push(e[n]) } var a = t.GameContent; a.awardArr = i; var r = a.awardArr, o = new Array; 12 == e.length ? a.lotteryLine = [r[0][0], r[0][1], r[0][2], r[0][3], r[1][1], r[2][1], r[3][3], r[3][2], r[3][1], r[3][0], r[2][0], r[1][0]] : a.lotteryLine = [r[0][0], r[0][1], r[0][2], r[1][1], r[2][2], r[2][1], r[2][0], r[1][0]]; for (var n = 0, s = r.length; s > n; n++) for (var d = 0, l = r[n].length; l > d; d++) { var h = r[n][d], u = { view: t.GameContent, width: t.AWARD_WIDTH, height: t.AWARD_WIDTH, x: (1 == n || 2 == n && 4 == t.ROW_NUM) && 1 == d ? t.AWARD_PANEL_X + t.MARGIN * t.ROW_NUM + t.AWARD_WIDTH * (t.ROW_NUM - 1) : t.AWARD_PANEL_X + t.MARGIN * (d + 1) + t.AWARD_WIDTH * d, y: t.AWARD_PANEL_Y + t.MARGIN * (n + 1) + t.AWARD_WIDTH * n, award: h, awardArr: r, uri: h.img, gview: t.LoadArr[n][d].gvd, gtext: t.LoadArr[n][d].gtext, com: function (e) { this.view.removeChild(this.gview), this.view.removeChild(this.gtext); var i = e, n = new egret.Bitmap(i); if (n.width = this.width, n.height = this.height, n.x = this.x, n.y = this.y, this.view.addChild(n), this.award.x = n.x, this.award.y = n.y, this.view.LoadPicNum++ , this.view.LoadPicNum == t.GameContent.WillLoadPicNum) { this.view.awardMark = new egret.Shape; var a = this.view.awardMark.graphics; a.lineStyle(2, 16711680, 0); var r = { color: "0xffffff", opacity: .3, rds: t.AWARD_WIDTH / 5, height: t.AWARD_WIDTH, width: t.AWARD_WIDTH }; window.ZlanLuck.Fill && (window.ZlanLuck.Fill.color && (r.color = window.ZlanLuck.Fill.color), window.ZlanLuck.Fill.opacity && (r.opacity = window.ZlanLuck.Fill.opacity), window.ZlanLuck.Fill.radius && (r.rds = window.ZlanLuck.Fill.radius), window.ZlanLuck.Fill.width && (r.width = window.ZlanLuck.Fill.width), window.ZlanLuck.Fill.height && (r.height = window.ZlanLuck.Fill.height), window.ZlanLuck.Fill.fx && (t.fX = window.ZlanLuck.Fill.fx), window.ZlanLuck.Fill.fy && (t.fY = window.ZlanLuck.Fill.fy)), a.beginFill(r.color, r.opacity), a.drawRoundRect(0, 0, r.width, r.height, r.rds, r.rds), a.endFill(), this.view.awardMark.x = -999, this.view.awardMark.blendMode = egret.BlendMode.ADD, this.view.addChild(this.view.awardMark), t.GameContent.btnLottery.touchEnabled = !0 } } }; o.push(u) } a.WillLoadPicNum = o.length, o.forEach(function (e) { RES.getResByUrl(e.uri, e.com, e, RES.ResourceItem.TYPE_IMAGE) }) } }, n.Pushluckbutton = function () { var e = t.GameContent, i = 1, n = 1, a = (1 == i || 2 == i && 4 == t.ROW_NUM) && 1 == n ? t.AWARD_PANEL_X + t.MARGIN * t.ROW_NUM + t.AWARD_WIDTH * (t.ROW_NUM - 1) : t.AWARD_PANEL_X + t.MARGIN * (n + 1) + t.AWARD_WIDTH * n; n = 0; var r = (1 == i || 2 == i && 4 == t.ROW_NUM) && 1 == n ? t.AWARD_PANEL_X + t.MARGIN * t.ROW_NUM + t.AWARD_WIDTH * (t.ROW_NUM - 1) : t.AWARD_PANEL_X + t.MARGIN * (n + 1) + t.AWARD_WIDTH * n, o = t.AWARD_PANEL_Y + t.MARGIN * (i + 1) + t.AWARD_WIDTH * i, s = (a - r - t.AWARD_WIDTH - t.BTN_LOTTERY_WIDTH) / 2; e.btnLottery = new egret.Bitmap(RES.getRes("btnLottery")), e.btnLottery.width = t.BTN_LOTTERY_WIDTH, e.btnLottery.height = t.BTN_LOTTERY_WIDTH, t.DIY_LOTTERY_HEIGHT > 0 && (e.btnLottery.height = t.DIY_LOTTERY_HEIGHT), t.DIY_LOTTERY_WIDTH > 0 && (e.btnLottery.width = t.DIY_LOTTERY_WIDTH), e.btnLottery.x = r + t.AWARD_WIDTH + s, e.btnLottery.y = o - t.MARGIN + s, 0 != t.DIY_LOTTERY_X && (e.btnLottery.x = t.DIY_LOTTERY_X), 0 != t.DIY_LOTTERY_Y && (e.btnLottery.y = t.DIY_LOTTERY_Y), e.addChild(e.btnLottery), e.btnLottery.touchEnabled = !1 }, n.init = function () { this.isStart = !1, this.panelIndex = 0, this.panelLastTime = egret.getTimer(), this.addEventListener(egret.TouchEvent.TOUCH_TAP, this.onTouchTap, this) }, n.childrenCreated = function () { e.prototype.childrenCreated.call(this), this.addEventListener(egret.Event.ENTER_FRAME, this.update, this) }, n.onTouchLuck = function () { window.ZlanLuck && window.ZlanLuck.onTouchLuck && window.ZlanLuck.onTouchLuck() }, n.onTouchTap = function (e) { var t = e.target; t === this.btnLottery && this.onTouchLuck() }, n.SetPrize = function (e) { window.ZlanLuck.giftCode = e }, n.LuckStart = function () { var e = t.GameContent; if (!e.isStart) { e.isStart = !0, e.btnLottery.touchEnabled = !1, window.ZlanLuck.giftCode = null, e.awardCode = null, e.markIndex || (e.markIndex = 0), e.lastTime = 0, e.awardCode = "", e.reduceOffset = 0; var i = e.awardArr[0][0]; e.awardMark.x = i.x - 2, e.awardMark.y = i.y - 2 } }, n.update = function () { this.isStart && this.markMove(); var e = egret.getTimer(); e - this.panelLastTime >= 500 && (this.panelIndex = (this.panelIndex + 1) % this.panelList.length, this.panel.source = this.panelList[this.panelIndex], this.panelLastTime = e) }, n.markMove = function () { var e = Math.floor(1e3 / (t.MARK_CHANGE_TIMES_PER_SECOND_MAX - this.reduceOffset)), i = egret.getTimer(); if (!(i - this.lastTime < e)) { this.awardCode = window.ZlanLuck.giftCode, this.awardCode && ("NULL" == this.awardCode && (this.isStart = !1, this.awardMark.visible = !1), t.MARK_CHANGE_TIMES_PER_SECOND_MAX - this.reduceOffset > t.MARK_CHANGE_TIMES_PER_SECOND_MIN && (this.reduceOffset += Math.ceil(t.MARK_CHANGE_TIMES_PER_SECOND_MAX * (i - this.lastTime) / 2e3), t.MARK_CHANGE_TIMES_PER_SECOND_MAX - this.reduceOffset < t.MARK_CHANGE_TIMES_PER_SECOND_MIN && (this.reduceOffset = t.MARK_CHANGE_TIMES_PER_SECOND_MAX - t.MARK_CHANGE_TIMES_PER_SECOND_MIN))), 0 == this.lastTime ? (this.lastTime = i, this.markIndex = ++this.markIndex % this.PrizeNum) : (this.markIndex = (this.markIndex + Math.floor((i - this.lastTime) / e)) % t.AWARD_COUNT, this.lastTime = i); var n = this.lotteryLine[this.markIndex]; this.awardMark.x = n.x + t.fX, this.awardMark.y = n.y + t.fY, t.MARK_CHANGE_TIMES_PER_SECOND_MAX - this.reduceOffset === t.MARK_CHANGE_TIMES_PER_SECOND_MIN && n.name === this.awardCode && (this.isStart = !1, egret.Tween.get(this.awardMark).wait(t.LASTPXTIME).set({ visible: !1 }, this.awardMark).wait(t.LASTPXTIME).set({ visible: !0 }, this.awardMark).wait(t.LASTPXTIME).set({ visible: !1 }, this.awardMark).wait(t.LASTPXTIME).set({ visible: !0 }, this.awardMark).wait(t.LASTPXTIME).set({ visible: !1 }, this.awardMark).wait(t.LASTPXTIME).set({ visible: !0 }, this.awardMark).call(function () { window.ZlanLuck && window.ZlanLuck.LuckEnd(), this.btnLottery.touchEnabled = !0 }, this)) } }, t.AWARD_COUNT = 12, t.AWARD_PANEL_X = 50, t.AWARD_PANEL_Y = 50, t.AWARD_PANEL_WIDTH = 800, t.AWARD_PANEL_HEIGHT = 800, t.ROW_NUM = 4, t.COL_NUM = 4, t.AWARD_WIDTH = 180, t.AWARD_RDS = t.AWARD_WIDTH / 5, t.BTN_LOTTERY_WIDTH = 340, t.DIY_LOTTERY_HEIGHT = 0, t.DIY_LOTTERY_WIDTH = 0, t.DIY_LOTTERY_X = 0, t.DIY_LOTTERY_Y = 0, t.DIY_PIC_NUM = 3, t.DIY_AWARD_WIDTH = 0, t.DIY_AWARD_RDS = 0, t.LASTPXTIME = 50, t.MARGIN = (t.AWARD_PANEL_WIDTH - t.AWARD_WIDTH * t.ROW_NUM) / (t.ROW_NUM + 1), t.MARK_CHANGE_TIMES_PER_SECOND_MAX = 100, t.MARK_CHANGE_TIMES_PER_SECOND_MIN = 100, t.fX = 0, t.fY = 0, t }(eui.Component); egret.registerClass(GamePlaying, "GamePlaying"); var LoadingUI = function (e) { function t() { e.call(this), this.createView() } __extends(t, e); var i = (__define, t), n = i.prototype; return n.createView = function () { this.textField = new egret.TextField, this.addChild(this.textField), this.textField.y = 900, this.textField.width = 900, this.textField.height = 100, this.textField.textAlign = "center" }, n.setProgress = function (e, t) { this.textField.text = "Loading..." + Math.floor(e / t * 100) + "%" }, t }(egret.Sprite); egret.registerClass(LoadingUI, "LoadingUI"); var Main = function (e) { function t() { e.apply(this, arguments), this.isThemeLoadEnd = !1, this.isResourceLoadEnd = !1 } __extends(t, e); var i = (__define, t), n = i.prototype; return n.createChildren = function () { e.prototype.createChildren.call(this); var t = new AssetAdapter; this.stage.registerImplementation("eui.IAssetAdapter", t), this.stage.registerImplementation("eui.IThemeAdapter", new ThemeAdapter), RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE, this.onConfigComplete, this), RES.loadConfig("resource/default.res.json", "resource/") }, n.onConfigComplete = function (e) { RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE, this.onConfigComplete, this); var t = new eui.Theme("/drawprize/resource/default.thm.json", this.stage); t.addEventListener(eui.UIEvent.COMPLETE, this.onThemeLoadComplete, this), RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE, this.onResourceLoadComplete, this), RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, this.onResourceLoadError, this), RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS, this.onResourceProgress, this), RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, this.onItemLoadError, this), RES.loadGroup("loading") }, n.onThemeLoadComplete = function () { this.isThemeLoadEnd = !0, this.createScene() }, n.onResourceLoadComplete = function (e) { "loading" == e.groupName ? (this.loadingView = new LoadingUI, this.stage.addChild(this.loadingView), RES.loadGroup("preload")) : "preload" == e.groupName && (this.stage.removeChild(this.loadingView), RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE, this.onResourceLoadComplete, this), RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, this.onResourceLoadError, this), RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS, this.onResourceProgress, this), RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, this.onItemLoadError, this), this.isResourceLoadEnd = !0, this.createScene()) }, n.createScene = function () { this.isThemeLoadEnd && this.isResourceLoadEnd && this.startCreateScene() }, n.onItemLoadError = function (e) { console.warn("Url:" + e.resItem.url + " has failed to load") }, n.onResourceLoadError = function (e) { console.warn("Group:" + e.groupName + " has failed to load"), this.onResourceLoadComplete(e) }, n.onResourceProgress = function (e) { "preload" == e.groupName && this.loadingView.setProgress(e.itemsLoaded, e.itemsTotal) }, n.startCreateScene = function () { var e = new GamePlaying; this.addChild(e) }, n.onButtonClick = function (e) { var t = new eui.Panel; t.title = "Title", t.horizontalCenter = 0, t.verticalCenter = 0, this.addChild(t) }, t }(eui.UILayer); egret.registerClass(Main, "Main"); var ThemeAdapter = function () { function e() { } var t = (__define, e), i = t.prototype; return i.getTheme = function (e, t, i, n) { function a(e) { t.call(n, e) } function r(t) { t.resItem.url == e && (RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, r, null), i.call(n)) } RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, r, null), RES.getResByUrl(e, a, this, RES.ResourceItem.TYPE_TEXT) }, e }(); egret.registerClass(ThemeAdapter, "ThemeAdapter", ["eui.IThemeAdapter"]);
    </script>
</head>

<body>
  <div style="background-color: #952121">
    <!-- <div style="position:absolute;top:0;width:100%;text-align:center;color:white;z-index:3">如遇缓存加载不出，点击此处<a href="javascript:void(0)" onclick="shuaxin()">刷新</a></div> -->
    <div style="position:relative;background-repeat:no-repeat;background-position:0 0;width:100%">
      <div style="width:100%;margin:0 auto;text-align: center;">
        <img style="width:100%" src="/drawprize/resource/newyearImg/titleback.png" />
      </div>
      <div style="background-image:url('/drawprize/resource/newyearImg/back.png');background-size:100%;margin:auto;top:0;left:0;height:100%;width:100%;overflow-y:auto;overflow-x:hidden">
        <div style="overflow: hidden;background-size:100%;position: relative;">
          <img src="./resource/newyearImg/i.png" id="img" alt="" style="width:100%;position: relative;">
          <div id="cans" style="margin: auto; width: 86%;height: 337px;overflow: hidden;top: 11.5%;transform: translate(0,-50%);"
            class="egret-player" data-entry-class="Main" data-orientation="auto" data-scale-mode="fixedWidth"
            data-frame-rate="30" data-content-width="900" data-content-height="1450" data-show-paint-rect="false"
            data-multi-fingered="2" data-show-fps="false" data-show-log="false" data-log-filter="" data-show-fps-style="x:0,y:0,size:30,textColor:0x00c200,bgAlpha:0.9">
            <audio style="display: none;"></audio>
          </div>
        </div>
        <div style="width:100%;margin-top:2rem;color: #8997c0;height:3rem;position:relative;">
          <img src="/drawprize/resource/newyearImg/changes.png" style="width:60%;position:absolute;left:20%;" />
          <span id="LuckCountSpan" style="left:38%;color: #fbf38f;font-size:2rem;position:absolute;top:-.8rem;display:inline-block;width:3.5rem;text-align:center">0</span>
        </div>
        <div style="text-align:center">
          <img src="/drawprize/resource/newyearImg/zj_btn.png" onclick="ZlanLuck.ShowWindow('MyPrize')" style="width:90%;margin-top:1.1rem" />
        </div>
        <!-- <a href="https://dvcms.weixinmvp.com/Mass/shop/index.html" style="text-align:center;margin-left: 25%;">
        <img src="./resource/images/scheng.png" alt="" style="width:50%;margin-top:1.1rem">
      </a> -->
        <!-- <div style="text-align:center;width:100%">
                <span style="color:white">因双十一客服繁忙，如您在页面中遇到任何问题，点此<a href="javascript:void(0)" onclick="ZlanLuck.ShowWindow('Advice')">此处</a>反馈问题，问题解决后将在第一时间内回复你</span>
            </div> -->
        <div style="text-align:center">
          <img src="/drawprize/resource/newyearImg/gz.png" style="height:1.6rem;margin-top:1.5rem" />
        </div>
        <div style="border-radius: 0.5rem; border: 2px dashed #fdebc5;width:80%;margin:auto;color:white;padding: 0.8rem 0.6rem 0.6rem 0.6rem;font-size:1.38rem;margin-bottom:4rem;margin-top:1rem">
          <div style="overflow: hidden;margin-bottom: .8rem;">
            <div style="width: 5vw;float: left;font-size: 1rem;color: #fff;">①</div>
            <div style="float: right;width: 74vw;font-size: 1rem;color: #fff;">2019年01月16日-2019年01月25日进入DV生活商城，既可参与抽奖。</div>
          </div>
          <div style="overflow: hidden;margin-bottom: .8rem;">
            <div style="width: 5vw;float: left;font-size: 1rem;color: #fff;">②</div>
            <div style="float: right;width: 74vw;font-size: 1rem;color: #fff;">活动时间内登陆DV生活商城每天可获得一次抽奖机会。</div>
          </div>
          <div style="overflow: hidden;margin-bottom: .8rem;">
            <div style="width: 5vw;float: left;font-size: 1rem;color: #fff;">③</div>
            <div style="float: right;width: 74vw;font-size: 1rem;color: #fff;">订单实付金额大于等于100元可获得一次额外抽奖机会（叠加，即200元可获得两次机会，以此类推）。</div>
          </div>
          <div style="overflow: hidden;margin-bottom: .8rem;">
            <div style="width: 5vw;float: left;font-size: 1rem;color: #fff;">④</div>
            <div style="float: right;width: 74vw;font-size: 1rem;color: #fff;">若用户获得的是优惠券，即刻生效，有效期2019年01月16号—2019年01月25号期间，年货节过后失效；若是获得福袋，获奖次日由商城发货。</div>
          </div>
          <div style="overflow: hidden;margin-bottom: .8rem;">
            <div style="width: 5vw;float: left;font-size: 1rem;color: #fff;">⑤</div>
            <div style="float: right;width: 74vw;font-size: 1rem;color: #fff;">如购物后出现取消订单等行为，获得福袋则自动失效。</div>
          </div>
          <div style="overflow: hidden;margin-bottom: .8rem;">
            <div style="width: 5vw;float: left;font-size: 1rem;color: #fff;">⑥</div>
            <div style="float: right;width: 74vw;font-size: 1rem;color: #fff;">为避免文字上的理解差异, DV商城保留最终决定权。</div>
          </div>
        </div>
        <div style="width:100%;height:100%;margin-bottom:2rem">
          <div style="text-align: center;width:100%;margin-bottom: 5%;">
            <img style="width:75%" src="/drawprize/resource/newyearImg/tj.png" alt="">
          </div>
          <div id="recom_sp" style="width:100%;height:100%;margin-left: 2.5%;">
            <a id="recom" href="https://gdtvshop.weixinmvp.com/Wap/ProductDetail/Default.aspx?no=111303122901" style="display: inline-block;text-decoration:none;width:30%;height:100%;background-color:#fff;border: 2px solid #ff5722;margin-bottom:2%;">
              <img src="http://gdtvimg.weixinmvp.com/res/gdtvimg/20161113/0d03db85e9de44ba8ec39177fc5178fb.jpg.thumb.jpg"
                alt="" style="width: 100%;bottom: 0;left: 0;">
              <div style="margin-left: 5%;margin-top: 6%;">
                <span style="font-family: SourceHanSansCN-Regular;font-size: 1.2rem;color: #606060;display: block;"></span>
                <span style="font-family: SourceHanSansCN-Regular;font-size: 0.8rem;color: #adadad;display: block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis"></span>
                <span style="font-family: SourceHanSansCN-Regular;font-size: 1rem;color: #913b44;display: block;"></span>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="zzcWindow" style="position:fixed;background-color:rgba(0,0,0,0.6);top:0;left:0;bottom:0;right:0;z-index:99;overflow:hidden;display:none;">
    <div id="MyPrize" style="width:25rem;position:absolute;top:15rem;left:50%;margin-left:-12.5rem;display:none">
      <img src="/drawprize/resource/newyearImg/min_jp.png" style="width:100%" />
      <div style="position:absolute;height:6rem;overflow-y:auto;z-index:99;top:2.5rem;width:23rem;left:1rem;height:15rem;background-color:transparent;border-radius:.3rem">
        <style>
          .MpRizelist {
                        margin: 0;
                        padding: 0;
                        list-style: none
                    }
                    .MpRizelist li {
                        color: #fff;
                        font-family: FZY3JW--GB1-0;
                        font-size: 1.3rem;
                        list-style: none;
                        margin: 0;
                        padding: 0;
                        position: relative;
                        width: 100%;
                        height: 3rem;
                        line-height: 3rem;
                    }
                    .MpRizelist li img {
                        position: absolute;
                        top: .5rem;
                        right: .25rem;
                        height: 2rem;
                    }
                </style>
        <ul class="MpRizelist" id="MpRizelist"></ul>
      </div>
      <span style="display:block;width:3rem;height:3rem;position:absolute;top:0;right:0" onclick="ZlanLuck.HideWindow()"></span>
      <div style="bottom:1rem;width:10rem;left:50%;margin-left:-5rem;position:absolute;height:3rem" onclick="ZlanLuck.HideWindow()"></div>
    </div>
    <div id="Prized" style="width:25rem;position:absolute;top:15rem;left:50%;margin-left:-12.5rem;display:none">
      <img src="/drawprize/resource/newyearImg/prized.png" style="width:100%" />
      <img src="./resource/images/cp.jpg" id="PrizedImg" style="top: 16%;z-index: 2;position: absolute;border-radius: .5rem;height: 9rem;left: 49%;transform: translateX(-50%);" />
      <div style="top:15.5rem;position:absolute;text-align:center;width:100%;left:0;font-size:1.3rem">
        <span style="color:#999999">恭喜您中奖：</span>
        <b style="color:#fb5038" id="PrizedName">奖品名奖品名</b>
      </div>
      <div style="bottom:1.5rem;width:10rem;right:1.6rem;position:absolute;height:3rem" onclick="ZlanLuck.HideWindow()"></div>
      <div style="bottom:1.5rem;width:10rem;left:1.6rem;position:absolute;height:3rem" onclick="ZlanLuck.ShowWindow('MyPrize')"></div>
    </div>
    <div id="WritePrize" style="width:25rem;position:absolute;top:15rem;left:50%;margin-left:-12.5rem">
      <img src="/drawprize/resource/newyearImg/writeprize.png" style="width:100%" />
      <input id="win_name" type="text" style="background:white;border:none;position:absolute;top: 4.55rem;left: 8.78rem;height: 1.8rem;width: 13.98rem;border-radius: .5rem;padding: 2%;" />
      <input id="win_tel" type="tel" style="background: white;border:none;position:absolute;top: 7.95rem;left: 8.78rem;height: 1.8rem;width: 13.98rem;border-radius: .5rem;padding: 2%;" />
      <textarea id="win_addr" type="tel" style="background: white;border: none;position: absolute;top: 11.47rem;left: 8.78rem;height: 3.5rem;width: 13.98rem;border-radius: .5rem;resize: none;padding: 2%;"></textarea>
      <span style="display:block;width:3rem;height:3rem;position:absolute;top:0;right:0" onclick="ZlanLuck.HideWindow()"></span>
      <div style="bottom:1rem;width:10rem;left:50%;margin-left:-5rem;position:absolute;height:3rem" onclick="ZlanLuck.WriteInfo()"></div>
    </div>
    <div id="Advice" style="width:25rem;position:absolute;top:15rem;left:50%;margin-left:-12.5rem;background-color:orangered;border-radius:.5rem;overflow:hidden">
      <div style="width:100%;color:white;text-align:center;font-size:1.8rem">反馈意见</div>
      <textarea id="k2lll" placeholder="请输入遇到的问题" style="width:100%;height:10rem;border:none;padding:0;resize:none;font-size:1.3rem"></textarea>
      <button style="color:white;background-color:orange;width:49%;border:none;padding:0;height:4em;display:inline-block"
        onclick="showadvice()">发送建议</button>
      <button style="color:black;background-color:white;width:49%;border:none;padding:0;height:4em;display:inline-block"
        onclick="ZlanLuck.HideWindow()">返回</button>
    </div>
  </div>

  <a href="https://dvcms.weixinmvp.com/Mass/shop/index.html" style="border-radius: 5px;opacity: .6;background-color:#333;position: fixed;right: 5%;top:80%;">
    <img src="./resource/newyearImg/home_btn.png" alt="" style="padding: .3rem;">
  </a>
  <script type=text/javascript> function search(key) { if (!key) return; var reg=new RegExp("(^|&)" + key +"=([^&]*)(&|$)"
    ); var url=window.location.search=='' ?window.location.hash.substring(window.location.hash.indexOf('?')) :
    window.location.search; var r=url.substr(1).match(reg);if (r !=null) return unescape(r[2]); return null; } var t=search('t');
    if (t==null) { var searchStr=window.location.search=='' ? window.location.hash : window.location.search; if
    (searchStr.indexOf('?')>-1) {searchStr += '&';} else {searchStr += '?';}searchStr += 't=' + new Date().valueOf();location.href = location.origin + location.pathname + searchStr;}
  </script>
  <script>
    egret.runEgret();
    ZlanLuck = {
      PrizeList: [],
      PrizeNum: 8,
      OnLoad: function () {
        ZlanLuck.GetAllPrize(function () {
          ZlanLuck.GetCount();
          ZlanLuck.GetMyPrize()
          ZlanLuck.Ajax({
            api: "GetPrizeInfo",
            data: {
              Kind: "SKILL"
            },
            success: function (data) {
              // console.log(data.Data.length)
              if (data.Data.length > 2) {
                ZlanLuck.PrizeList = data.Data;
                var plist = [];
                for (var i = 0; i < 8 && i < ZlanLuck.PrizeList.length; i++) {
                  plist.push({
                    "x": 0,
                    "y": 0,
                    "name": ZlanLuck.PrizeList[i].PrizeCode,
                    "img": "/DrawPrize/resource/prize/" + ZlanLuck.PrizeList[i].PrizeCode + ".png?t=" +
                      new Date().getTime()
                  })
                }

                if (plist.length < 8) {
                  var fob = {
                    PrizeCode: "NoWin"
                  } //data.Data.PrizeList.find(function (p) { return p.Default })

                  while ((8 - plist.length) > 0) {

                    plist.push({
                      "x": 0,
                      "y": 0,
                      "name": fob.PrizeCode,
                      "img": "/DrawPrize/resource/prize/" + fob.PrizeCode + ".png?t=" + new Date().getTime()
                    })

                  }
                }
                ZlanLuck.LoadPrize(plist);
                ZlanLuck.IsLoaded = true;
              } else {
                alert("活动尚未开始")
              }
            }
          })
        })
      },
      onTouchLuck: function () {
        if (!ZlanLuck.IsLoaded) return;
        if (ZlanLuck.LuckCount > 0) {
          //开始抽奖
          this.LuckStart();
          ZlanLuck.LuckCount = ZlanLuck.LuckCount - 1;
          LuckCountSpan.innerText = ZlanLuck.LuckCount;
          ZlanLuck.Ajax({
            api: "DrawPrize",
            data: {
              Kind: "SKILL"
            },
            success: function (data) {
              var prize;
              if (data.Data) {
                prize = data.Data;
                ZlanLuck.GetMyPrize();
              } else {
                prize = {};
                prize.PrizeCode = "NoWin";
                prize.PrizedName = "谢谢参与";
              }
              ZlanLuck.SetPrize(prize.PrizeCode);
              ZlanLuck.LastPrize = prize;

            },
            error: function (data) {
              var prize = {};
              prize.PrizeCode = "NoWin";
              prize.PrizedName = "谢谢参与";
              ZlanLuck.SetPrize(prize.PrizeCode);
              ZlanLuck.LastPrize = prize;
              console.log(data.ErrorMessage);
            },
            finish: function () {
              ZlanLuck.GetCount();
            }
          })
        } else {
          alert("明日再来抽奖，每天都有一次免费抽奖等着你");
        }
      },
      LuckEnd: function () {
        //抽奖完毕
        //需加入不中奖代码
        console.log("抽奖完毕");

        if (ZlanLuck.LastPrize.PrizeCode === "NoWin") {
          alert("手气不好，未中奖,换个姿势再试试吧");
        } else {
          ZlanLuck.ShowWindow('Prized');
          PrizedImg.src = "/DrawPrize/resource/prize2/" + ZlanLuck.LastPrize.PrizeCode + ".png?t=" + new Date().getTime();
          PrizedName.innerText = ZlanLuck.LastPrize.PrizeName;
        }
      },
      LuckButton: {
        //height:340,//如果有这两个数据，会变化中间按钮的大小，否则自适应,且不能为0
        //width:340,//如果有这两个数据，会变化中间按钮的大小，否则自适应,且不能为0
        //x:100,//同上,且不能为0
        //y:100//同上,且不能为0
      },
      Award: {
        width: 250, //奖品大小
        minspeed: 10, //慢速转动频率
        maxspeed: 50, //快速转动频率
        lastpxtime: 350 //最后闪动的间隔
      },
      Background: {
        // "/drawprize/resource/newyearImg/i.png", "/drawprize/resource/newyearImg/itwo.png"
        panelList: [],
        width: 900,
        height: 900,
        x: 0,
        y: 0

      },

      Fill: {
        color: "0xffffff",
        opacity: 0.3,
        radius: 50, //初始化圆角大小
        //	height:180,
        //width:180,
        fx: 5,
        fy: -5
      },
      Ajax: function (ajaxSetting) {
        var httpreq = new XMLHttpRequest();
        httpreq.onreadystatechange = function () {
          if (httpreq.readyState === 4) {
            if (ajaxSetting.loadword) {

            }
            if (httpreq.status === 200) {
              data = httpreq.responseText;

              try {
                data = JSON.parse(httpreq.responseText)
              } catch (e) {
                if (ajaxSetting.error && typeof ajaxSetting.error === "function") {
                  ajaxSetting.error({
                    ErrorCode: -500,
                    ErrorMessage: "返回的数据不是json"
                  });
                }
              }

              if (data.ErrorCode != 0) {
                if (data.ErrorCode === -2 || data.ErrorCode === -3) {
                  ZlanLuck.Login(""); //登录
                }
                if (ajaxSetting.error && typeof ajaxSetting.error === "function") {
                  ajaxSetting.error(data);
                }

              } else {

                if (ajaxSetting.success && typeof ajaxSetting.success === "function") {
                  ajaxSetting.success(data)
                }
              }
            } else {
              if (ajaxSetting.error && typeof ajaxSetting.error === "function") {
                var errdata3 = httpreq.responseText;
                ajaxSetting.error({
                  ErrorCode: -500,
                  ErrorMessage: errdata3
                });
              }
            }
            if (ajaxSetting.finish && typeof ajaxSetting.finish === "function") {
              ajaxSetting.finish(httpreq.responseText)
            }
          }
        }
        httpreq.open("POST", "/api/Activity/" + ajaxSetting.api, true);
        httpreq.setRequestHeader("Content-Type", "application/json");
        if (!ajaxSetting.data) ajaxSetting.data = {}
        if (ZlanLuck.MemberToken) httpreq.setRequestHeader("MemberToken", ZlanLuck.MemberToken);

        var senddata = JSON.stringify(ajaxSetting.data)

        if (ajaxSetting.before && typeof ajaxSetting.before === "function") {
          ajaxSetting.before()
        }
        if (ajaxSetting.loadword) {

        }
        httpreq.send(senddata);
      },
      get MemberToken() {
        return localStorage.getItem("token");
      },
      set MemberToken(str) {
        localStorage.setItem("token", str);
      },
      LuckCount: 0,
      GetCount() {
        ZlanLuck.Ajax({
          api: "LoadDrawCount",
          loadword: "获取抽奖次数",
          data: {
            Kind: "login"
          },
          success: function (data) {
            ZlanLuck.LuckCount = data.Data;
            LuckCountSpan.innerText = ZlanLuck.LuckCount;
          }
        })
      },
      IsLoaded: false,
      ShowWindow: function (name) {
        var ac = zzcWindow.children
        for (var i = 0; i < ac.length; i++) {
          ac[i].style.display = 'none';
        }
        zzcWindow.style.display = "block";
        if (name)
          document.getElementById(name).style.display = 'block';
      },
      HideWindow: function (name) {
        zzcWindow.style.display = "none";
      },
      LastPrize: null,
      MyPrizeList: [],
      Login: function (code) {
        localStorage.setItem('gotoUrl', location.href);
        var Url = escape(location.origin + '/dist/index.html#/login/loginShop');
        var loginUrl = /*'http://192.168.0.120:8000/OAuth/Server/GetMemberCode.aspx?goto=' + Url;*/ 'https://gdtvshop.weixinmvp.com/OAuth/Server/GetMemberCode.aspx?goto=' + Url;
        location.href = loginUrl;
      },
      WritePrizeId: null,

      GetMyPrize: function () {
        ZlanLuck.Ajax({
          api: "LoadPrizeList",
          data: {
            Kind: "SKILL",
            PageIndex: 1,
            PageSize: 100
          },
          success: function (data) {
            ZlanLuck.MyPrizeList = data.Data;
            MpRizelist.innerHTML = "";
            ZlanLuck.MyPrizeList.forEach(function (p) {
              var ali = document.createElement("li");
              ali.setAttribute("data-id", p.Recid)
              var span = document.createElement("li");
              var img = document.createElement("img");
              span.innerText = p.PrizeName
              img.dataId = p.status;
              img.onclick = function (e) {
                if (p.Status == 9 || p.Kind == 'Coupon') return
                var pid = parseInt(e.target.parentElement.getAttribute("data-id"))
                ZlanLuck.WritePrizeId = pid;
                ZlanLuck.ShowWindow('WritePrize');
              }
              ali.appendChild(span);
              if (p.Kind != "Coupon") {
                if (p.Status == 9) {
                  img.src = "./resource/images/yilingjiang.png";
                  ali.appendChild(img);

                } else {
                  img.src = "./resource/images/lingjiang.png";
                  ali.appendChild(img);
                }

              } else {
                img.src = "./resource/images/yilingjiang.png";
                ali.appendChild(img);
              }
              MpRizelist.appendChild(ali);
            });
          },
          error: function () {

          }
        });
      },
      AllPrize: [],
      GetAllPrize: function (backfunction) {
        backfunction();
        //ZlanLuck.Ajax({
        //    api: "GetAllPrizeInfo",
        //    data: { activityid: "ssycj" },
        //    success: function (data) {
        //        ZlanLuck.AllPrize = data.Data;
        //        if (backfunction) backfunction()
        //    }
        //})
      },
      WriteInfo: function () {
        if (win_name.value && win_tel.value && win_addr.value) {
          if (win_tel.value.length == 11) {
            if (confirm("是否提交领奖信息（不可更改，填错概不负责）？")) {
              ZlanLuck.Ajax({
                // api: "WritePrizeInfo",
                api: "EditWinnerInfo",
                data: {
                  Id: ZlanLuck.WritePrizeId,
                  WinnerInfo: JSON.stringify({
                    Address: win_addr.value,
                    Tel: win_tel.value,
                    Name: win_name.value
                  })
                },
                type: 'POST',
                dataType: 'json',
                success: function (data) {
                  ZlanLuck.GetMyPrize();
                  ZlanLuck.ShowWindow('MyPrize');
                },
                error: function (data) {
                  alert(data.ErrorMessage);
                }
              });
            }
          } else {
            alert("请填写正确的手机号码");
          }
        } else {
          alert("请填写完整的领奖信息");
        }
      },
    }

    function showadvice() {
      ZlanLuck.Ajax({
        api: "SendAdvice",
        data: {
          Token: ZlanLuck.MemberToken,
          Advice: k2lll.value
        },
        success: function (e) {
          ZlanLuck.HideWindow()
          alert("发送成功，感谢您的建议")
        }
      })
    }
  </script>
  <script>
    if (!ZlanLuck.MemberToken) {
      ZlanLuck.Login("");
    }
    var _hmt = _hmt || [];
    (function () {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?290e7b3ea81e18569ee34cb9d775cb90";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
      var path = '20190119luckdraw|home|' + document.URL + '|' + document.referrer;

      _hmt.push(['_trackEvent', 'page', 'view', '20190119luckdraw']);
    })();

    function drawprize(mass) {
      var path = "20190119luckdraw";
      _hmt.push(['_trackEvent', path, 'click', '20190119luckdraw']);
    }
  </script>
  <script>
    var imgs = ["/drawprize/resource/newyearImg/i.png", "/drawprize/resource/newyearImg/itwo.png", ];
    var index = 0;

    function qiehuan() {
      document.getElementById("img").src = imgs[index];
      index++;
      if (index > 1) {
        index = 0;
      }
    }
    setInterval("qiehuan()", 500);
  </script>
</body>
<script>
  var darw = this.productList;
  name(darw);

  function name(darw) {
    var html = '';
    for (var i = 0; i < darw.length; i++) {
      var element = darw[i];
      html +=
        '<a id="recom" onclick=drawprize("' + element.prodcutNo + '|' + i +
        '") href="https://gdtvshop.weixinmvp.com/Wap/ProductDetail/Default.aspx?no=' + element.prodcutNo +
        '" style="margin-right:.3rem;display:inline-block;text-decoration:none;width:30%;height:100%;background-color:#fff;border: 2px solid #ff5722;margin-bottom:2%;">' +
        '<div style="padding-bottom: 100%;position: relative;background-color: #fff;"><img src="' + element.img +
        '" alt="" style=" position: absolute; top: 50%;transform: translateY(-50%);width: 100%;left: 0;"></div>' +
        '<div style="margin-left: 5%;margin-top: 6%;">' +
        '<span style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;font-size: 1rem;color: #606060;display: block;">' +
        element.productName + '</span>' +
        '<span style="font-size: 0.8rem;color: #adadad;display: block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">' +
        element.describe + '</span>' +
        '<span style="font-size: 1rem;color: #913b44;display: block;">¥' + element.productPriPrc +
        '</span>' +
        '</div>' +
        '</a>'
    }
    document.getElementById('recom_sp').innerHTML = html;
  }
</script>

</html>